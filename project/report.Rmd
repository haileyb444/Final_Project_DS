---
title: "Exploring and Analyzing the Effects of Sleep Patterns on College Students"
output:
  html_document:
    toc: yes
    toc_float: yes
    toc_depth: '2'
    df_print: paged
  html_notebook:
    number_sections: yes
    toc: yes
    toc_depth: 2
    toc_float: yes
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(warning = FALSE)
```


## Team Members

**Hailey Bauer**

[Contact Information](mailto:hbauer2783@floridapoly.edu)

<br>
**Nolan Nguyen**

[Contact Information](mailto:nnguyen3353@floridapoly.edu)
 
 
 


# Introduction

College students often have lots of assignments to do, early classes, and many other activities that occupy their time. All of these factors influence their sleep and therefore their mental health, physical health, and academic performance. We strive to discover how these factors influence students through the following research question:


   - What is the distribution of sleep quality among college students and are there any significant factors affecting sleep quality (drinking, stress, depression, anxiety, etc.) and is there a correlation between the number of hours slept and cognitive function scores on the skill test?
  
  
Let's explore and answer these questions.

Our project investigates 254 students who were surveyed for this sleep study including characteristics such as the quantity of early classes taken, GPA, quantity and quality of sleep, depression score, anxiety score, stress score, etc. This is our project for Foundations of Data Analytics (Fall 2023) class.


<br> 

# Prerequisites

Load the following R packages required for the data analysis...

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
```


<br> 

# Data Description

First, import the dataset and set it as a variable.

```{r}
# Read the dataset
SleepStudy <- read.csv("https://raw.githubusercontent.com/haileyb444/datasets/master/SleepStudy.csv")
```

Then, take a random sample of the dataset.

```{r}
sample_n(SleepStudy, 10)
```


<br>

# Exploratory Data Analysis

First to take an initial look at the basic data statistics...

```{r}
summary(SleepStudy)
```

Through our preliminary observations of the `SleepStudy` dataset we noticed that several variables were hard to understand at first glance, were not all formatted in the same manner, and one variable should be classified as a character value instead of an integer for data analysis purposes. We used the following code to conduct this data cleaning process, ultimately improving the readability of the dataset.

```{r}
# Replace the indicator values in various columns so as to create an easier to read dataset.
SleepStudy["Gender"][SleepStudy["Gender"] == 0] <- "F"

SleepStudy["Gender"][SleepStudy["Gender"] == 1] <- "M"

SleepStudy["EarlyClass"][SleepStudy["EarlyClass"] == 0] <- "No"

SleepStudy["EarlyClass"][SleepStudy["EarlyClass"] == 1] <- "Yes"

SleepStudy["AllNighter"][SleepStudy["AllNighter"] == 0] <- "No"

SleepStudy["AllNighter"][SleepStudy["AllNighter"] == 1] <- "Yes"


# Change variables to be the same throughout
SleepStudy[SleepStudy == "moderate"] <- "Moderate"

SleepStudy[SleepStudy == "normal"] <- "Normal"

SleepStudy[SleepStudy == "severe"] <- "Severe"

SleepStudy[SleepStudy == "high"] <- "High"

# Set the Class Year column as a character value
SleepStudy$ClassYear <- as.character(SleepStudy$ClassYear)

# Print a sample of the improved dataframe
sample_n(SleepStudy, 10)
```


## Univariate Exploration

Initiating the univariate exploration of the `SleepStudy` dataframe marks the commencement of a nuanced journey into the intricate realm of sleep patterns among the surveyed individuals. As we initiate this phase of analysis, we focus on individual variables, with the goal of comprehensively understanding their distributions, trends, and inherent characteristics. In this exploration, we strive to investigate each variable, unraveling the singular story encapsulated within the data. 

### Sleep Quality

**EDIT**
In the realm of sleep study research, the variable `PoorSleepQuality` within the `SleepStudy` dataframe serves as a crucial metric, encapsulating the diverse experiences of surveyed college students. Representing a quantitative measure of sleep quality, this variable unveils a spectrum of data points where higher values correspond to poorer sleep quality. As we delve into the intricate details of this dataset, we gain valuable insights into the sleep patterns of college students, shedding light on the factors influencing their sleep quality and laying the foundation for a comprehensive analysis of the relationship between various variables and the overall well-being of these individuals.

```{r}
SleepStudy %>% 
  ggplot() +
  geom_histogram(aes(x = PoorSleepQuality)) +
  theme_minimal() +
  labs(x = "", 
       y = "Frequency",
       caption = "Data Source: SleepStudy dataframe",
       title = "Distribution of Poor Sleep Quality Among College Students")
```


### Demographics{.tabset .tabset-fade .tabset-pills}


#### Gender

```{r}
ggplot(data = SleepStudy) +
  geom_bar(aes(x = Gender, fill = Gender)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(x = "",
       y = "Frequency",
       caption = "Data Source: SleepStudy dataframe",
       title = "Distribution of Gender Among College Students") 
  
```


#### ClassYear
```{r}
ggplot(data = SleepStudy) +
  geom_bar(aes(x = ClassYear, fill = ClassYear)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(x = "",
       y = "Frequency",
       caption = "Data Source: SleepStudy dataframe",
       title = "Distribution of Class Year Among College Students")
```


#### Sleep Habits
```{r}
SleepStudy %>% 
  ggplot() +
  geom_bar(aes(x = LarkOwl, fill = LarkOwl)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(x = "",
       y = "Frequency",
       caption = "Data Source: SleepStudy dataframe",
       title = "Distribution of Sleep Habits Among College Students")
```


### Mental Health Factors {.tabset .tabset-fade .tabset-pills}


#### Depression

```{r}
ggplot(data = SleepStudy) +
  geom_histogram(aes(x = DepressionScore, fill = DepressionStatus)) +
  theme_minimal() +
  labs(x = "",
       y = "Frequency",
       fill = "Depression Status",
       caption = "Data Source: SleepStudy dataframe",
       title = "Distribution of Depression Among College Students") 
  
```


#### Anxiety
```{r}
ggplot(data = SleepStudy) +
  geom_histogram(aes(x = AnxietyScore, fill = AnxietyStatus)) +
  theme_minimal() +
  labs(x = "",
       y = "Frequency",
       fill = "Anxiety Status",
       caption = "Data Source: SleepStudy dataframe",
       title = "Distribution of Anxiety Among College Students") 
```


#### Stress

```{r}
ggplot(data = SleepStudy) +
  geom_histogram(aes(x = StressScore, fill = Stress)) +
  theme_minimal() +
  labs(x = "",
       y = "Frequency",
       fill = "Stress Level",
       caption = "Data Source: SleepStudy dataframe",
       title = "Distribution of Stress Among College Students") 
```


### Alcohol
```{r}
ggplot(data = SleepStudy) +
  geom_histogram(aes(x = Drinks, fill = AlcoholUse)) +
  theme_minimal() +
  labs(x = "Alcoholic Beverages Consumed (per week)",
       y = "Frequency",
       fill = "Alcohol Consumption Level",
       caption = "Data Source: SleepStudy dataframe",
       title = "Distribution of Alcohol Consumption Among College Students") 
```

Note that the students in the sleep survey self-reported their level of alcohol use (`AlcoholUse`). This causes variations to occur as each individual's understanding and criteria for the labels differ. For example, one student reported their alcohol use as "light" while stating that they drank an average of 24 alcoholic beverages per week while another student reported their alcohol use as "heavy" while drinking an average of 5 alcoholic beverages per week.


We have standardized these labels as it relates to the dataset so as to provide a more accurate result for the distribution of alcoholic beverages consumed on a weekly basis by college students and their drinking significance labels.

```{r}
# Create a new dataset with the refined drinking significance labels
AlcoholUse_Refined <- SleepStudy %>% 
  mutate(AlcoholUse_Refined = ifelse(Drinks == 0, "Abstain", 
                                     ifelse(Drinks <= 5, "Light", 
                                            ifelse(Drinks <= 9, "Moderate", "Heavy"))))
AlcoholUse_Refined
```

```{r}
ggplot(data = AlcoholUse_Refined) +
  geom_histogram(aes(x = Drinks, fill = AlcoholUse_Refined)) +
  theme_minimal() +
  labs(x = "Alcoholic Beverages Consumed (per week)",
       y = "Frequency",
       fill = "Alcohol Consumption Level",
       caption = "Data Source: SleepStudy dataframe",
       title = "Refined Distribution of Alcohol Consumption Among College Students")
```


## Multivariate Exploration

**EDIT**
Venturing into the realm of multivariate exploration within the SleepStudy dataframe marks a pivotal juncture in our investigative journey. Unlike the solitary focus of univariate analysis, this phase invites us to navigate the intricate interplay among various variables, unlocking a mosaic of insights into the nuanced landscape of sleep patterns. As we delve into the complexities of these interconnected factors, our goal is to unearth hidden patterns, correlations, and dependencies that collectively shape the diverse tapestry of sleep-related behaviors. This multifaceted exploration transcends the confines of individual variables, providing a holistic panorama that enriches our comprehension of the intricate dynamics governing the sleep experiences of the surveyed individuals. Each variable, in this context, contributes a unique hue to the comprehensive canvas of understanding, revealing a story that extends beyond isolated metrics and into the intricacies of sleep study.

### Sleep Quality by Significant Factors


#### Demographics {.tabset .tabset-fade .tabset-pills}


##### Gender

```{r}
SleepStudy %>% 
  ggplot() +
  geom_boxplot(aes(y = PoorSleepQuality, color = Gender)) +
  scale_y_continuous(breaks = seq(0, 20, by = 2)) +
  facet_wrap(vars(Gender)) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(x = "",
       y = "Poor Sleep Quality",
       caption = "Data Source: SleepStudy dataframe",
       title = "Poor Sleep Quality Aggregated by Gender Among College Students")
```


##### Class Year

```{r}
SleepStudy %>% 
  ggplot() +
  geom_boxplot(aes(y = PoorSleepQuality, color = ClassYear)) +
  scale_y_continuous(breaks = seq(0, 20, by = 2)) +
  facet_wrap(vars(ClassYear)) +
  theme_bw() +
  theme(legend.position = "none")+
  labs(x = "",
       y = "Poor Sleep Quality",
       caption = "Data Source: SleepStudy dataframe",
       title = "Poor Sleep Quality Aggregated by Class Year Among College Students")
```


##### Sleep Habits

```{r}
SleepStudy %>% 
  ggplot() +
  geom_boxplot(aes(y = PoorSleepQuality, color = LarkOwl)) +
  scale_y_continuous(breaks = seq(0, 20, by = 2)) +
  facet_wrap(vars(LarkOwl)) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(x = "",
       y = "Poor Sleep Quality",
       caption = "Data Source: SleepStudy dataframe",
       title = "Poor Sleep Quality Aggregated by Sleep Habits Among College Students")
```


#### Mental Health Factors {.tabset .tabset-fade .tabset-pills}


##### Depression

```{r}
SleepStudy %>% 
  ggplot() +
  geom_boxplot(aes(y = PoorSleepQuality, color = DepressionStatus)) +
  scale_y_continuous(breaks = seq(0, 20, by = 2)) +
  facet_wrap(vars(DepressionStatus)) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(x = "",
       y = "Poor Sleep Quality",
       caption = "Data Source: SleepStudy dataframe",
       title = "Poor Sleep Quality Aggregated by Depression Status Among College Students")
```

```{r}
ggplot(SleepStudy, aes(x = DepressionScore, y = PoorSleepQuality, color = DepressionStatus)) +
  geom_point(alpha = 0.5) +
  geom_smooth() +
  theme_minimal() +
  labs(x = "Depression Score",
       y = "Poor Sleep Quality",
       color ="Depression Status",
       caption = "Data Source: SleepStudy dataframe",
       title = "Depression Relavent to Poor Sleep Quality")
```


##### Anxiety

```{r}
SleepStudy %>% 
  ggplot() +
  geom_boxplot(aes(y = PoorSleepQuality, color = AnxietyStatus)) +
  scale_y_continuous(breaks = seq(0, 20, by = 2)) +
  facet_wrap(vars(AnxietyStatus)) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(x = "",
       y = "Poor Sleep Quality",
       caption = "Data Source: SleepStudy dataframe",
       title = "Poor Sleep Quality Aggregated by Anxiety Status Among College Students")

```

```{r}
ggplot(SleepStudy, aes(x = AnxietyScore, y = PoorSleepQuality, color = AnxietyStatus)) +
  geom_point(alpha = 0.5) +
  geom_smooth() +
  theme_minimal() +
  labs(x = "Anxiety Score",
       y = "Poor Sleep Quality",
       color ="Anxiety Status",
       caption = "Data Source: SleepStudy dataframe",
       title = "Anxiety Relavent to Poor Sleep Quality")
```


##### Stress

```{r}
SleepStudy %>% 
  ggplot() +
  geom_boxplot(aes(y = PoorSleepQuality, color = Stress)) +
  scale_y_continuous(breaks = seq(0, 20, by = 2)) +
  facet_wrap(vars(Stress)) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(x = "",
       y = "Poor Sleep Quality",
       caption = "Data Source: SleepStudy dataframe",
       title = "Poor Sleep Quality Aggregated by Stress Level Among College Students")
```

```{r}
ggplot(SleepStudy, aes(x = StressScore, y = PoorSleepQuality, color = Stress)) +
  geom_point(alpha = 0.5) +
  geom_smooth() +
  theme_minimal() +
  labs(x = "Stress Score",
       y = "Poor Sleep Quality",
       color ="Stress Level",
       caption = "Data Source: SleepStudy dataframe",
       title = "Stess Relavent to Poor Sleep Quality")
```


#### Alcohol

```{r}
AlcoholUse_Refined %>% 
  ggplot() +
  geom_boxplot(aes(y = PoorSleepQuality, color = AlcoholUse_Refined)) +
  scale_y_continuous(breaks = seq(0, 20, by = 2)) +
  facet_wrap(vars(AlcoholUse_Refined)) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(x = "", 
       y = "Poor Sleep Quality", 
       title = "Poor Sleep Quality by GPA Aggregated by Alcohol Use") 

```

```{r}
ggplot(AlcoholUse_Refined, aes(x = Drinks, y = PoorSleepQuality, color = AlcoholUse_Refined)) +
  geom_point(alpha = 0.5) +
  geom_smooth() +
  theme_minimal() +
  labs(x = "Alcoholic Beverages Consumed (per week)",
       y = "Poor Sleep Quality",
       color ="Alcohol Consumption Level",
       caption = "Data Source: SleepStudy dataframe",
       title = "Alcohol Consumption Relavent to Poor Sleep Quality")
```


#### Academic Factors {.tabset .tabset-fade .tabset-pills}


##### GPA

```{r}
ggplot(AlcoholUse_Refined, aes(x = GPA, y = PoorSleepQuality)) +
  geom_point(alpha = 0.5) +
  geom_smooth() +
  theme_minimal() +
  labs(x = "GPA",
       y = "Poor Sleep Quality",
       caption = "Data Source: SleepStudy dataframe",
       title = "GPA Relavent to Poor Sleep Quality")
```


##### Classes Missed

```{r}
ggplot(AlcoholUse_Refined, aes(x = ClassesMissed, y = PoorSleepQuality)) +
  geom_point(alpha = 0.5) +
  geom_smooth() +
  theme_minimal() +
  labs(x = "Classes Missed",
       y = "Poor Sleep Quality",
       caption = "Data Source: SleepStudy dataframe",
       title = "Quantity of Classes Missed Relavent to Poor Sleep Quality")
```


##### Early Classes

```{r}
SleepStudy %>% 
  ggplot() +
  geom_boxplot(aes(y = PoorSleepQuality, color = EarlyClass)) +
  scale_y_continuous(breaks = seq(0, 20, by = 2)) +
  facet_wrap(vars(EarlyClass)) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(x = "",
       y = "Poor Sleep Quality",
       caption = "Data Source: SleepStudy dataframe",
       title = "Poor Sleep Quality Aggregated by Early Classes Among College Students")
```


##### Allnighters

```{r}
SleepStudy %>% 
  ggplot() +
  geom_boxplot(aes(y = PoorSleepQuality, color = AllNighter)) +
  scale_y_continuous(breaks = seq(0, 20, by = 2)) +
  facet_wrap(vars(AllNighter)) +
  theme_bw() +
  theme(legend.position = "none") +
  labs(x = "",
       y = "Poor Sleep Quality",
       caption = "Data Source: SleepStudy dataframe",
       title = "Poor Sleep Quality Aggregated by All Nighters Among College Students")
```


### Quantity of Sleep by Cognitive Function Scores

```{r}
SleepStudy %>% 
  ggplot(aes(x = CognitionZscore, y = AverageSleep)) +
  geom_boxplot() +
  theme_bw() +
  labs(x = "Cognition Z Score",
       y = "Average Sleep",
       caption = "Data Source: SleepStudy dataframe",
       title = "Cognition Z Score Aggregated by Average Sleep Among College Students")
```

```{r}
cor.test(SleepStudy$AverageSleep, SleepStudy$CognitionZscore)
```

```{r}
ggplot(SleepStudy, aes(x = CognitionZscore, y = AverageSleep)) +
  geom_point(alpha = 0.5) +
  geom_smooth() +
  theme_minimal() +
  labs(x = "Cognition Z Score",
       y = "Average Sleep",
       caption = "Data Source: SleepStudy dataframe",
       title = "Cognition Z Score Relavent to Quantity of Average Sleep")
```
<br>

# Data Analysis


## What is the distribution of sleep quality among college students?


## Are there any significant factors affecting sleep quality?


## Is there a correlation between the number of hours slept and cognitive function scores on the skill test?

<br>

# Conclusion

<br>

# Future Applications

<br>

# Datasets Cited


